@echo off
echo Starting DuckDB import...

echo Processing data_category...
duckdb data/olap_data.duckdb ".read data/export/data_category.sql"

echo Processing data_option...
duckdb data/olap_data.duckdb ".read data/export/data_option.sql"

echo Processing data_option_parents...
duckdb data/olap_data.duckdb ".read data/export/data_option_parents.sql"

echo Processing data_tradeinvestmentdata...
duckdb data/olap_data.duckdb ".read data/export/data_tradeinvestmentdata.sql"

echo Processing api_productcode...
duckdb data/olap_data.duckdb ".read data/export/api_productcode.sql"

echo Processing data_productcode...
duckdb data/olap_data.duckdb ".read data/export/data_productcode.sql"

echo Processing data_hstradedata...
duckdb data/olap_data.duckdb ".read data/export/data_hstradedata.sql"

echo Processing data_internationalcooperation...
duckdb data/olap_data.duckdb ".read data/export/data_internationalcooperation.sql"

echo Verifying import...
duckdb data/olap_data.duckdb "SELECT table_name, COUNT(*) as row_count FROM information_schema.tables JOIN (SELECT table_name as tn, COUNT(*) as cnt FROM main.data_category GROUP BY table_name) ON table_name = tn WHERE table_schema = 'main'"
echo Import completed!
